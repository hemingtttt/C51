#include <REGX52.H>

//定时器0初始化
void Timer0_Init() //这个函数可以通过软件直接生成的！！！，但是没有中断，即最后三个
{
    //定时器
	//TMOD=0x01; //0000 0001  高四位  低四位
    TMOD=TMOD&0xF0; //把TMOD的低四位清0，高四位保持不变
    TMOD=TMOD|0x01; //把TMOD的最低位置为1，高四位保持不变
	TF0=0; //TF0是进入中断程序后，硬件自动清零
	TR0=1; //定时器从0开始计时
    
    //TH0,TL0为二进制8位，单独可计256次   低8位计满256后高8位进1
    //设置定时初值
	TH0=64535/256; //高8位次数 
	TL0=64535%256; //低8位次数
    
    //中断
    ET0=1;
    EA=1;
    PT0=0; //设置优先级
}

//主程序
void main()
{
	Timer0_Init();
	while(1)
	{
		
	}
}

//中断服务程序B
unsigned int T0Count;
void Timer0_Routine() interrupt 1
{
	TH0=64535/256;
	TL0=64535%256; //重新赋值
	T0Count++; //每次加1us,1000次就是1s
	if (T0Count>=1000)
	{
		  T0Count=0; //重新赋值
		  P2_0=~P2_0; //每1s闪烁一次
	}

}
